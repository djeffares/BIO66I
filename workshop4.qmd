---
title: "BIO00066I Workshop 4"
subtitle: "Cell Biology Data Analysis Workshop 4"

author: Daniel Jeffares
date: 2024-03-16
format:
    html:
        code-link: true
        toc: true
        number-sections: true
        toc-location: right
        toc-depth: 2
        
editor: source
---


# Learning objectives

::: callout-important
## Philosophy

- **Workshops are not a test.** 
- Don't worry about making mistakes. 
- The staff are here to help.
:::

## Technical skills

Today, we will learn how to:
 
- create a linear model, and use it to predict the a *y* value, given an *x* value
- in our case we use absorbance *x* to predict alkaline phosphatase activity *y*

## Thinking like a data scientist

# Introduction

## The biology

## Research questions

## The data
In this workshop we bla bla

# Exercises (Part 1): Standard curve

## Load libraries (install packages)

```{r}
rm(list=ls())
library(tidyverse)
library(readxl)
library(ggpubr)
#install.packages("gganimate")
#install.packages("gifski")
library(gganimate)
```


## Load data

read in excel

```{r}
ap<-read_excel("raw-data/Example Alkaline Phosphatase Activity assay .xlsx", sheet=2, skip=3)
view(ap)
```


simplify the data with pivot_longer

```{r}
ap.pivot <- 
  ap |> 
  select(-mean.abs, -standard.deviation) |>
  pivot_longer(-pNPP.conc, names_to = "rep", values_to = "absorb")
view(ap.pivot)
```

reorder columns, so it is more intuitive 

```{r}
ap.pivot <- relocate(ap.pivot, absorb)
```

## Plot enzyme data

```{r}
pNPP.plot <- ap.pivot |>
  ggplot(aes(x=absorb, y=pNPP.conc))+
  geom_point()+
  geom_smooth(method="lm")
pNPP.plot
```

How close are the reps? What if we use `ggplot(aes(x=absorb, y=pNPP.conc,colour = rep))`


save the plot with ggsave
```{r}
ggsave("pNPP.plot.pdf",pNPP.plot)  
```


## Make a linear model

```{r}
linear_model <- lm(pNPP.conc ~ absorb , data = ap.pivot)
absorbance_values <- data.frame(absorb = c(1,2,3))
```

Given some absorbence values, make a prediction of some pNPP concentrations

```{r}
predicted.pnpp.concs <- predict(linear_model,absorbance_values)
predicted.pnpp.concs
```



# Exercises (Part 2): Exploring MCS movement

## Part 3

# Reflection

# After the workshop

## Consolodation exercises

Optional

## Planning for your report
