<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.545">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Daniel Jeffares">
<meta name="dcterms.date" content="2024-03-16">
<title>BIO00066I - BIO00066I Workshop 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BIO00066I</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workshop2.html"> 
<span class="menu-text">Workshop 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workshop3.html"> 
<span class="menu-text">Workshop 3</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./workshop4.html" aria-current="page"> 
<span class="menu-text">Workshop 4</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
<li>
<a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><span class="header-section-number">1</span> Learning objectives</a>
  <ul class="collapse">
<li><a href="#technical-skills" id="toc-technical-skills" class="nav-link" data-scroll-target="#technical-skills"><span class="header-section-number">1.1</span> Technical skills</a></li>
  <li><a href="#thinking-like-a-data-scientist" id="toc-thinking-like-a-data-scientist" class="nav-link" data-scroll-target="#thinking-like-a-data-scientist"><span class="header-section-number">1.2</span> Thinking like a data scientist</a></li>
  </ul>
</li>
  <li>
<a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2</span> Introduction</a>
  <ul class="collapse">
<li><a href="#the-biology" id="toc-the-biology" class="nav-link" data-scroll-target="#the-biology"><span class="header-section-number">2.1</span> The biology</a></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions"><span class="header-section-number">2.2</span> Research questions</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">2.3</span> The data</a></li>
  </ul>
</li>
  <li>
<a href="#exercises-part-1-standard-curve" id="toc-exercises-part-1-standard-curve" class="nav-link" data-scroll-target="#exercises-part-1-standard-curve"><span class="header-section-number">3</span> Exercises (Part 1): Standard curve</a>
  <ul class="collapse">
<li><a href="#load-libraries-install-packages" id="toc-load-libraries-install-packages" class="nav-link" data-scroll-target="#load-libraries-install-packages"><span class="header-section-number">3.1</span> Load libraries (install packages)</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data"><span class="header-section-number">3.2</span> Load data</a></li>
  <li><a href="#plot-enzyme-data" id="toc-plot-enzyme-data" class="nav-link" data-scroll-target="#plot-enzyme-data"><span class="header-section-number">3.3</span> Plot enzyme data</a></li>
  <li><a href="#make-and-use-a-linear-model" id="toc-make-and-use-a-linear-model" class="nav-link" data-scroll-target="#make-and-use-a-linear-model"><span class="header-section-number">3.4</span> Make and use a linear model</a></li>
  </ul>
</li>
  <li>
<a href="#predict-values-based-on-a-linear-model" id="toc-predict-values-based-on-a-linear-model" class="nav-link" data-scroll-target="#predict-values-based-on-a-linear-model"><span class="header-section-number">4</span> Predict values based on a linear model</a>
  <ul class="collapse">
<li><a href="#making-a-bar-plot-of-predicted-pnp-concetrations" id="toc-making-a-bar-plot-of-predicted-pnp-concetrations" class="nav-link" data-scroll-target="#making-a-bar-plot-of-predicted-pnp-concetrations"><span class="header-section-number">4.1</span> Making a bar plot of predicted pNP concetrations</a></li>
  <li><a href="#end-of-part-1." id="toc-end-of-part-1." class="nav-link" data-scroll-target="#end-of-part-1."><span class="header-section-number">4.2</span> End of Part 1.</a></li>
  </ul>
</li>
  <li>
<a href="#exercises-part-2-exploring-mcs-movement" id="toc-exercises-part-2-exploring-mcs-movement" class="nav-link" data-scroll-target="#exercises-part-2-exploring-mcs-movement"><span class="header-section-number">5</span> Exercises (Part 2): Exploring MCS movement</a>
  <ul class="collapse">
<li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data"><span class="header-section-number">5.1</span> Loading data</a></li>
  <li><a href="#what-is-in-the-point-data" id="toc-what-is-in-the-point-data" class="nav-link" data-scroll-target="#what-is-in-the-point-data"><span class="header-section-number">5.2</span> What is in the ‘point’ data?</a></li>
  <li><a href="#exploratory-plots" id="toc-exploratory-plots" class="nav-link" data-scroll-target="#exploratory-plots"><span class="header-section-number">5.3</span> Exploratory plots</a></li>
  <li><a href="#scatter-plots-to-show-cell-movement-range-intuitively" id="toc-scatter-plots-to-show-cell-movement-range-intuitively" class="nav-link" data-scroll-target="#scatter-plots-to-show-cell-movement-range-intuitively"><span class="header-section-number">5.4</span> Scatter plots to show cell movement range intuitively</a></li>
  <li><a href="#animate-it" id="toc-animate-it" class="nav-link" data-scroll-target="#animate-it"><span class="header-section-number">5.5</span> Animate it!</a></li>
  </ul>
</li>
  <li>
<a href="#revision" id="toc-revision" class="nav-link" data-scroll-target="#revision"><span class="header-section-number">6</span> Revision</a>
  <ul class="collapse">
<li><a href="#data-analysis-1-core" id="toc-data-analysis-1-core" class="nav-link" data-scroll-target="#data-analysis-1-core"><span class="header-section-number">6.1</span> Data Analysis 1: Core</a></li>
  <li><a href="#workshop-2-cell-biology" id="toc-workshop-2-cell-biology" class="nav-link" data-scroll-target="#workshop-2-cell-biology"><span class="header-section-number">6.2</span> Workshop 2: Cell Biology</a></li>
  <li><a href="#workshop-3-cell-biology" id="toc-workshop-3-cell-biology" class="nav-link" data-scroll-target="#workshop-3-cell-biology"><span class="header-section-number">6.3</span> Workshop 3: Cell Biology</a></li>
  <li><a href="#workshop-4-cell-biology-this-workshop" id="toc-workshop-4-cell-biology-this-workshop" class="nav-link" data-scroll-target="#workshop-4-cell-biology-this-workshop"><span class="header-section-number">6.4</span> Workshop 4: Cell Biology (this workshop)</a></li>
  </ul>
</li>
  <li>
<a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="header-section-number">7</span> Reflection</a>
  <ul class="collapse">
<li><a href="#consolodation-exercises" id="toc-consolodation-exercises" class="nav-link" data-scroll-target="#consolodation-exercises"><span class="header-section-number">7.1</span> Consolodation exercises</a></li>
  <li><a href="#planning-for-your-report" id="toc-planning-for-your-report" class="nav-link" data-scroll-target="#planning-for-your-report"><span class="header-section-number">7.2</span> Planning for your report</a></li>
  </ul>
</li>
  <li>
<a href="#supplementary-analysis-three-way-anova" id="toc-supplementary-analysis-three-way-anova" class="nav-link" data-scroll-target="#supplementary-analysis-three-way-anova"><span class="header-section-number">8</span> Supplementary analysis: three-way ANOVA</a>
  <ul class="collapse">
<li><a href="#read-data-and-reformat-with-pivot_longer" id="toc-read-data-and-reformat-with-pivot_longer" class="nav-link" data-scroll-target="#read-data-and-reformat-with-pivot_longer"><span class="header-section-number">8.1</span> Read data and reformat with <code>pivot_longer</code></a></li>
  <li><a href="#make-some-plots" id="toc-make-some-plots" class="nav-link" data-scroll-target="#make-some-plots"><span class="header-section-number">8.2</span> Make some plots</a></li>
  <li><a href="#anova-additive-model" id="toc-anova-additive-model" class="nav-link" data-scroll-target="#anova-additive-model"><span class="header-section-number">8.3</span> ANOVA (additive model)</a></li>
  <li><a href="#anova-multiplicative-model" id="toc-anova-multiplicative-model" class="nav-link" data-scroll-target="#anova-multiplicative-model"><span class="header-section-number">8.4</span> ANOVA (multiplicative model)</a></li>
  </ul>
</li>
  <li><a href="#the-end" id="toc-the-end" class="nav-link" data-scroll-target="#the-end"><span class="header-section-number">9</span> The End</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">BIO00066I Workshop 4</h1>
<p class="subtitle lead">Cell Biology Data Analysis Workshop 4</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Jeffares </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 16, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="learning-objectives" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Learning objectives</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Philosophy
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Workshops are not a test.</strong></li>
<li>Don’t worry about making mistakes.</li>
<li>The staff are here to help.</li>
</ul>
</div>
</div>
<section id="technical-skills" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="technical-skills">
<span class="header-section-number">1.1</span> Technical skills</h2>
<p>Today, we will learn how to:</p>
<ul>
<li>Use a linear model to predict some <strong><em>y</em></strong> values, given some <strong><em>x</em></strong> values</li>
<li>In our case we use absorbance (<strong><em>x</em></strong> <strong>values</strong>) to predict alkaline phosphatase activity (<strong><em>y</em></strong> <strong>values</strong>)</li>
<li>Make <strong>animated plots</strong> with <code>gganimate</code>
</li>
</ul></section><section id="thinking-like-a-data-scientist" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="thinking-like-a-data-scientist">
<span class="header-section-number">1.2</span> Thinking like a data scientist</h2>
<p>It might seem like a lot of trouble to use <strong>R</strong> to read in a small number of <strong><em>x</em></strong> and <strong><em>y</em></strong> values from an Excel sheet to a standard curve, and then estimate some new <strong><em>y</em></strong> values. We <em>could</em> probably do this in Excel.</p>
<p>But what if we have 200 standard curves, and we want to automate the process? What if we have 50,000 <strong><em>x</em></strong> and <strong><em>y</em></strong> values and a non-linear model? For big data, <strong>R (or some similar software) is the only sensible way</strong>. NB: There are <a href="https://www.inwt-statistics.com/blog/comparison-of-r-python-sas-spss-and-stata">similar software for statistical analysis</a>, but we don’t teach them here. R is currently the state of the art for analysis of biological data. And it’s <em>free</em>.</p>
</section></section><section id="introduction" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Introduction</h1>
<section id="the-biology" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="the-biology">
<span class="header-section-number">2.1</span> The biology</h2>
<p>We saw in workshop 3 that clone A moves faster than clone B. This time we will use R to explore MCS cell movement in more depth. Use <strong><em>x</em></strong> and <strong><em>y</em></strong> coordinates from <em>manually</em> tracked cells. We have 10 manually tracked cell lineages of clone A and 9 manually tracked cell lineages of clone B. Today, we will explore the ways these lineages move.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="docs/figure1.jpg" class="img-fluid figure-img"></p>
<figcaption><strong>Figure 1.</strong> The <strong>tracking ID (TID)</strong> is a unique ID that the microscope assigned to each object (cell), as it tracks it through time. The <strong>lineage ID (LID)</strong> is a number assigned to the ‘family’ of cells that derived by cell division during the the experiment. When a cell divides, each daughter cell is given a new tracking ID, but they keep their lineage ID, because they are still part of the same family.</figcaption></figure>
</div>
<p>To help address our research question of whether morphology and migration can be used to predict MSC phenotype, we also need to investigate the phenotype (ability to differentiate) of the two clonal lines. In practical 4 we’ll explore the potency of the two clonal lines by looking at their capacity to undergo <em>osteogenesis</em> (differentiate into osteoblasts - bone cells) when they are given an inductive media.</p>
<p>We can use an enzyme called <em>alkaline phosphatase</em> as a biomarker to quantify osteogenesis in the cells, as the activity of the enzyme increases in cells undergoing osteogenesis as osteoblasts use the enzyme when producing bone extracellular matrix. To measure the activity of the enzyme we mix the lysate (cellular contents) of the cells with the substrate for the enzyme, para-nitrophenyl phosphate (pNPP) and measure the rate of product formation over time. The product of the reaction is para-nitro phenol (pNP) and we can measure it <em>colorimetrically</em> as it absorbs light at a known wavelength.</p>
<p>Creating a standard curve and estimating values from this curve is <em>Part 1</em> of our analysis today. <em>Part 2</em> is looking at cell movement data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Same coding methods, different data
</div>
</div>
<div class="callout-body-container callout-body">
<p>The methods we use to examine cells moving on <em>x</em> and <em>x</em> coordinates would be used any location data that tracks objects objects in a two-dimensional plane over time; traffic, birds, slugs, people<em>.</em> with consent</p>
</div>
</div>
</section><section id="research-questions" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="research-questions">
<span class="header-section-number">2.2</span> Research questions</h2>
<ul>
<li>What is the osteogenic potential of clonal lines A and B (Part 1)</li>
<li>Can we see differences in how clonal lines A and B move?</li>
<li>How can we display this data visually?</li>
<li>Do cells ‘follow’ each other in the petri dish?</li>
</ul></section><section id="the-data" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="the-data">
<span class="header-section-number">2.3</span> The data</h2>
<section id="part-1-pnp-absorbance-values" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="part-1-pnp-absorbance-values">
<span class="header-section-number">2.3.1</span> Part 1: pNP absorbance values</h3>
<p>Once you’ve completed Practical 4 you’ll have your own data to use to make the standard curve of pNP and absorbance values for each of the clonal line time points. You should use your own standard curve data from the practical as well as your unknown values as the readings for absorbance will vary based on the plate the samples are in and the plate reader used.</p>
<p>To create the standard curve you have the absorbance readings for 8 concentrations of pNP in triplicate. To measure osteogenesis in the two clonal lines, samples of the cells were grown in an inductive media for 8 days. The cells were then lysed at different time points to measure the quantity of alkaline phosphatase and explore how it varies over time and between the two clonal lines. The clonal lines were analysed at Day 0, Day 4 and Day 8. At each time point you have data for both induced cells and non-induced cells (negative control), with the exception of Day 0 as the differentiation was induced at Day 1. There are four repeated measures for the data at each time point.</p>
</section><section id="part-2-manually-tracked-cell-movement-point-data" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="part-2-manually-tracked-cell-movement-point-data">
<span class="header-section-number">2.3.2</span> Part 2: manually-tracked cell movement ‘point’ data</h3>
<p>The Livecyte data that tracked cells automatically was unreliable. In <a href="https://djeffares.github.io/BIO66I/workshop3.html#manual-tracking-data">workshop 3</a> we looked at some manual tracking data. This contained information like <code>track.length</code>, the <code>meandering.index</code>, <code>euclidean.distance</code> and so on. This time we look at manual data in it’s raw form: <strong><em>x</em></strong> and <strong><em>y</em></strong> coordinates of the cells, tracked over time.</p>
<p>We can of course extract information from this about how far the cells travel, and how fast they travel (because we have distance and time measurements). But, we can do much more. This time we will be able to visualise the paths they take in culture dish. We may observe interesting patterns by studying this data.</p>
</section></section></section><section id="exercises-part-1-standard-curve" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Exercises (Part 1): Standard curve</h1>
<p>To quantify the concentration of pNP and therefore the activity of the enzyme in unknown samples we’ll create a standard curve of known values of pNP and then interpolate the unknown pNP values in our sample from this.</p>
<section id="load-libraries-install-packages" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="load-libraries-install-packages">
<span class="header-section-number">3.1</span> Load libraries (install packages)</h2>
<p>First, install the <code>gganimate</code> package. We will use this to creating moving plots later. You only need to do this once.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install a new package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"gganimate"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then load all the libraries we’ll need today.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com">gganimate</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="load-data" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="load-data">
<span class="header-section-number">3.2</span> Load data</h2>
<p>First, read in some ata from an Excel file. You can obtain <a href="https://djeffares.github.io/BIO66I/example_alkaline_phosphatase_activity_assay-2024-03-21.xlsx">an example file from here</a>. Click to download, and then save the file in your <strong>raw-data</strong> directory. If you don’t have a <strong>raw-data</strong> directory, make one!</p>
<p>Then read in the Excel file. Two important things to note about reading Excel files:</p>
<ul>
<li>we use <code>sheet=1</code> to specify that we want the first sheet (or tab)</li>
<li>we use <code>skip=3</code> to specify that we want to skip the first three lines (because they are comments, not data)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ap</span><span class="op">&lt;-</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"raw-data/example_alkaline_phosphatase_activity_assay-2024-03-21.xlsx"</span>, sheet<span class="op">=</span><span class="fl">1</span>, skip<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check what we have</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/view.html">view</a></span><span class="op">(</span><span class="va">ap</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then simplify the data with <code>pivot_longer</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ap.pivot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">ap</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">mean.abs</span>, <span class="op">-</span><span class="va">standard.deviation</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">pNP.conc</span>, names_to <span class="op">=</span> <span class="st">"rep"</span>, values_to <span class="op">=</span> <span class="st">"absorb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/view.html">view</a></span><span class="op">(</span><span class="va">ap.pivot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Reorder the columns, so it is more intuitive for us using <code>relocate</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ap.pivot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">ap.pivot</span>, <span class="va">absorb</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="plot-enzyme-data" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="plot-enzyme-data">
<span class="header-section-number">3.3</span> Plot enzyme data</h2>
<p>Let’s make a simple plot, adding a line that shows the linear model with the line <code>geom_smooth(method="lm")</code>. The <code>method="lm</code> means plotting a linear model.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#plot, saving thr plot in an object called 'pNP.plot'</span></span>
<span><span class="va">pNP.plot</span> <span class="op">&lt;-</span> <span class="va">ap.pivot</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">absorb</span>, y<span class="op">=</span><span class="va">pNP.conc</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#show the plot</span></span>
<span><span class="va">pNP.plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop4_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now save the plot:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"pNP.plot.pdf"</span>,<span class="va">pNP.plot</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional: How close are the replicates?
</div>
</div>
<div class="callout-body-container callout-body">
<p>How similar to the linear models look if you use: <code>ggplot(aes(x=absorb, y=pNP.conc,colour = rep))</code></p>
</div>
</div>
</section><section id="make-and-use-a-linear-model" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="make-and-use-a-linear-model">
<span class="header-section-number">3.4</span> Make and use a linear model</h2>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linear_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">pNP.conc</span> <span class="op">~</span> <span class="va">absorb</span> , data <span class="op">=</span> <span class="va">ap.pivot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have the linear model, if we have some some pNP absorbence values, we can make a prediction of the pNPP enzyme concentrations. We have put some mock pNP values in the excel file <code>example_alkaline_phosphatase_activity_assay-2024-03-21.xlsx</code>, in sheet two. You’ll need to adjust the code below to correct <code>sheet=0, skip=0</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mock</span><span class="op">&lt;-</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"raw-data/example_alkaline_phosphatase_activity_assay-2024-03-21.xlsx"</span>, sheet<span class="op">=</span><span class="fl">0</span>, skip<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check what we have</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/view.html">view</a></span><span class="op">(</span><span class="va">mock</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we calculate the average for each of the three explicates using <code>mutate</code>. Note that <code>mutate</code> is a very useful function for creating new columns using existing ones. It can also join text columns. We can also use <code>select</code> <em>after</em> the mutation to remove the replicate columns.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mock</span> <span class="op">&lt;-</span> <span class="va">mock</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>absorb<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">absorb.rep1</span>,<span class="va">absorb.rep2</span>,<span class="va">absorb.rep3</span><span class="op">)</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We named our mean absorbance <code>absorb</code> because we specified the <code>absorb</code> variable in the code <code>linear_model &lt;- lm(pNP.conc ~ absorb , data = ap.pivot)</code> above. So our linear model is ‘looking for’ an absorb variable to use.</p>
</section></section><section id="predict-values-based-on-a-linear-model" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Predict values based on a linear model</h1>
<p>Here is how do it, using the <code>predict</code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#calculate predicted pNP concentration using the linear model</span></span>
<span><span class="va">predictions.from.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">linear_model</span>,<span class="va">mock</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Add these predictions from the linear model (predictions.from.lm)</span></span>
<span><span class="co">#As a new column</span></span>
<span><span class="va">mock</span><span class="op">$</span><span class="va">predicted.pNP.concs</span> <span class="op">=</span> <span class="va">predictions.from.lm</span></span>
<span></span>
<span><span class="co">#check what we have</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/view.html">view</a></span><span class="op">(</span><span class="va">mock</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#And save all our data (give your Rda file a sensible name!)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save.image</a></span><span class="op">(</span><span class="st">"chocolate-fish.Rda"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="making-a-bar-plot-of-predicted-pnp-concetrations" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="making-a-bar-plot-of-predicted-pnp-concetrations">
<span class="header-section-number">4.1</span> Making a bar plot of predicted pNP concetrations</h2>
<p>First, we need to ensure that the <code>day</code>, <code>clone</code> and <code>differentiated</code> columns are set as **factors*. This is important because we want to treat these columns as <strong>categories</strong>, not <strong>numeric values</strong>:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mock</span><span class="op">$</span><span class="va">day</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mock</span><span class="op">$</span><span class="va">day</span><span class="op">)</span></span>
<span><span class="va">mock</span><span class="op">$</span><span class="va">clone</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mock</span><span class="op">$</span><span class="va">clone</span><span class="op">)</span></span>
<span><span class="va">mock</span><span class="op">$</span><span class="va">differentiated</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mock</span><span class="op">$</span><span class="va">differentiated</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can make a plot:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#make the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">mock</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>, y<span class="op">=</span><span class="va">predicted.pNP.concs</span>,fill<span class="op">=</span><span class="va">clone</span><span class="op">:</span><span class="va">differentiated</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop4_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Note</strong> that this dummy data may look <em>very</em> different from your real data.</p>
</section><section id="end-of-part-1." class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="end-of-part-1.">
<span class="header-section-number">4.2</span> End of Part 1.</h2>
<hr></section></section><section id="exercises-part-2-exploring-mcs-movement" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Exercises (Part 2): Exploring MCS movement</h1>
<section id="loading-data" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="loading-data">
<span class="header-section-number">5.1</span> Loading data</h2>
<p>First, load the data from the website, and check what you have:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#load data from a URL</span></span>
<span><span class="va">points</span><span class="op">&lt;-</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://djeffares.github.io/BIO66I/points.data.2024-03-16.csv"</span><span class="op">)</span>,</span>
<span>                 col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span>LID <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span>,TID <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span>,pid <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check what we have</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">points</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">points</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="what-is-in-the-point-data" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="what-is-in-the-point-data">
<span class="header-section-number">5.2</span> What is in the ‘point’ data?</h2>
<p>This data contains the positions of cells, tracked over time. Lineages are tracked. We have data for tracked cells for both clones (A and B). We have the following information, for many time points:</p>
<ul>
<li>lineage ID (LID)</li>
<li>tracking ID (TID)</li>
<li>data point id* (pid)</li>
<li>the location of the cell in <em>x</em> and <em>y</em> coordinates (x.position, y.position)</li>
<li>the time point (time)</li>
<li>movement metrics (track.length, euclidean.distance, velocity)</li>
<li>a new movement metric: howfar the cell moved between this time ppint, and thr last one (jump.distance)</li>
<li>clone (A/B)</li>
</ul>
<p>NB: <strong>pid</strong> describes what data point the row of data corresponds to for a cell with a specific LID and TID. For example, LID 1 TID 1 PID 1 would correspond to the first data point (it’s x and Y coordinates etc) for a cell with TID 1 from lineage 1.</p>
</section><section id="exploratory-plots" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="exploratory-plots">
<span class="header-section-number">5.3</span> Exploratory plots</h2>
<section id="recap-how-fast-do-they-move" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="recap-how-fast-do-they-move">
<span class="header-section-number">5.3.1</span> Recap: how fast do they move</h3>
<p>You’ll notice that this file has velocity, just like the last file we used in workshop 3. For a simple ‘sanity check’, we will tests again that the clones differ.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>We know that clone A moves faster than clone B. So why do it again?</strong></p>
<p><strong>Answer:</strong> data hygiene. We want to be very sure our data is good.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">points</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">clone</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">velocity</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What does this do?
</div>
</div>
<div class="callout-body-container callout-body">
<p>To find out what any function does, type <code>?function</code> in the RStudio Console. For example to find out what <code>glimpse</code> does:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="va">glimpse</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="plotting-cell-movement-tracks" class="level3" data-number="5.3.2"><h3 data-number="5.3.2" class="anchored" data-anchor-id="plotting-cell-movement-tracks">
<span class="header-section-number">5.3.2</span> Plotting cell movement tracks</h3>
<p>Now, let’s examine the directions do the cells move in. A simple way to do this is to plot the <em>x</em> and <em>y</em> coordinates. We will use <code>facet_wrap</code> to plot one boz for each lineage ID <code>LID</code>. Remember, a lineage ID contains information for each cell, and all its daughter cell and so on.</p>
<p>To keep our image simple, we allow clone A and clone B to be on the same panels. But note that <strong>clone A, lineage ID 1</strong> has no relationship to <strong>clone A, lineage ID 2</strong> - they are merely the first lineage ID that Amanda tracked.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">points</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.position</span>,y<span class="op">=</span><span class="va">y.position</span>,colour<span class="op">=</span><span class="va">clone</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">LID</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#If we want to show just one clone add this line after 'points |&gt;'</span></span>
<span><span class="co">#filter(clone == "A")|&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see that they wriggle about a lot. They do not move in straight lines. To show one lineage, from one clone and colour by TID (or time), we can do:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">points</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">clone</span> <span class="op">==</span> <span class="st">"B"</span> <span class="op">&amp;</span> <span class="va">LID</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.position</span>,y<span class="op">=</span><span class="va">y.position</span>,colour<span class="op">=</span><span class="va">TID</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="scatter-plots-to-show-cell-movement-range-intuitively" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="scatter-plots-to-show-cell-movement-range-intuitively">
<span class="header-section-number">5.4</span> Scatter plots to show cell movement range intuitively</h2>
<p>If we want to view how far many different cells have moved, we will need to adjust their point locations, so the <strong>median</strong> of their <code>x.position</code>s and <code>x.position</code>s are zero. Effectively setting all their start positions to x=0,y=0 on a grid.</p>
<p>We can use some simple math and the <code>mutate</code> function to achieve this:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#use mutate to make new columns</span></span>
<span><span class="va">points2</span><span class="op">&lt;-</span> <span class="va">points</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">LID</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>med.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x.position</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>adjusted.x <span class="op">=</span>  <span class="va">x.position</span> <span class="op">-</span> <span class="va">med.x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>med.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y.position</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>adjusted.y <span class="op">=</span>  <span class="va">y.position</span> <span class="op">-</span> <span class="va">med.y</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check our new data</span></span>
<span><span class="va">points2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the ‘centralised’ (x=0,y=0) cell positions. We use <code>facet_wrap</code> to show each clone on a different panel.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">points2</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">adjusted.x</span>,y<span class="op">=</span><span class="va">adjusted.y</span>,colour <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">clone</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="animate-it" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="animate-it">
<span class="header-section-number">5.5</span> Animate it!</h2>
<p><code>ggplot2</code> can achieve <em>almost</em> any plot you can image (and probably some you cant imagine!). To create very visually appealing graphics can help enormously to explain complex data. Animated plots are much more intuitive for explaining data with a <em>time</em> element.</p>
<p>Here is now to make an amimated plot with <code>gganimate</code>:</p>
<section id="animate-step-1." class="level3" data-number="5.5.1"><h3 data-number="5.5.1" class="anchored" data-anchor-id="animate-step-1.">
<span class="header-section-number">5.5.1</span> Animate: step 1.</h3>
<p>Make a static plot:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">static.plot</span> <span class="op">&lt;-</span><span class="va">points</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">clone</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="va">LID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.position</span>,y<span class="op">=</span><span class="va">y.position</span>, colour<span class="op">=</span><span class="va">TID</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span>, pch<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">static.plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Here we only look at one clone and one lineage ID</strong> in the line<br><code>filter(clone == "B", LID == 1) |&gt;</code><br></p>
<p>You can (and should) alter the code to look at other clone and lineage IDs. You might also like to try these alternatives:</p>
<ul>
<li><code>colour=time</code></li>
<li><code>facet_wrap(~LID)</code></li>
<li><code>geom_point(size=5, pch=1)</code></li>
</ul></section><section id="animate-step-2" class="level3" data-number="5.5.2"><h3 data-number="5.5.2" class="anchored" data-anchor-id="animate-step-2">
<span class="header-section-number">5.5.2</span> Animate: step 2</h3>
<p>Animate the plot:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#set up the animation code</span></span>
<span><span class="va">animated.plot</span> <span class="op">&lt;-</span> <span class="va">static.plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/transition_time.html">transition_time</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/shadow_mark.html">shadow_mark</a></span><span class="op">(</span>past <span class="op">=</span> <span class="cn">T</span>, future<span class="op">=</span><span class="cn">F</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check the animation worked</span></span>
<span><span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span><span class="va">animated.plot</span>, width <span class="op">=</span><span class="fl">800</span>, height <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="animate-step-3" class="level3" data-number="5.5.3"><h3 data-number="5.5.3" class="anchored" data-anchor-id="animate-step-3">
<span class="header-section-number">5.5.3</span> Animate: step 3</h3>
<p>Save the animation as a GIF:</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#save the animation as a gif</span></span>
<span><span class="co">#make sure you use a sensible file name</span></span>
<span><span class="fu"><a href="https://gganimate.com/reference/anim_save.html">anim_save</a></span><span class="op">(</span><span class="st">"cloneB.ineage2gif"</span>, <span class="va">animated.plot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://gganimate.com/index.html">See this website</a> to learn more about <code>gganimate</code>.</p>
<p>That is all for this workshop today. If you have time do look at the revision summary below.</p>
</section></section></section><section id="revision" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Revision</h1>
<p>This section will summarise what we have learned in the <a href="https://3mmarand.github.io/R4BABS/r4babs4/week-1/workshop.html">BABS core workshop</a> and cell biology workshops; <a href="https://djeffares.github.io/BIO66I/workshop2.html">workshop 2</a>, <a href="https://djeffares.github.io/BIO66I/workshop3.html">workshop 3</a> and <a href="https://djeffares.github.io/BIO66I/workshop4.html">workshop 4</a> (this one).</p>
<p><strong>If you don’t recall, or are unsure about, any of these topics - look at them again.</strong> Two principles of data science are worth recalling now:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1. Technical skills are important
</div>
</div>
<div class="callout-body-container callout-body">
<p>To be a skilled data analyst, you need to master some technical skills. <strong>This is worth putting time and effort into</strong>, because there is a demand for skilled data analysts, both within and outside of science. <a href="https://uk.indeed.com/q-data-analyst-l-york-jobs.html">This website is an example</a>.</p>
<p>In this module you have learned these technical skills:</p>
<ul>
<li>loading libraries and installing packages</li>
<li>importing data</li>
<li>filtering rows to obtain subset of the data (using <code>filter</code>)</li>
<li>selecting columns to keep data simple (using <code>select</code>)</li>
<li>creating plots</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
2. Data-handling principles are also important
</div>
</div>
<div class="callout-body-container callout-body">
<p>These are:</p>
<ul>
<li>keep files and scripts organised</li>
<li>name variables carefully</li>
<li>comment your code</li>
<li>make your analysis clear and reproducible</li>
</ul>
</div>
</div>
<p>We will now summarise and review what we have learned in each workshop.</p>
<section id="data-analysis-1-core" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="data-analysis-1-core">
<span class="header-section-number">6.1</span> <a href="https://3mmarand.github.io/R4BABS/r4babs4/week-1/workshop.html">Data Analysis 1: Core</a>
</h2>
<p>In this workshop, we learned:</p>
<ul>
<li>How to achieve reproducibility</li>
<li>Setting up an RStudio Project</li>
<li>Loading packages</li>
<li>The importance of looking at, and knowing, your data</li>
<li>Creating plots with <code>ggplot</code> to help with knowing your data</li>
<li>Quality control</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
It is the undertanding that matters
</div>
</div>
<div class="callout-body-container callout-body">
<p>Understanding takes time. Be sure you understand all these concepts well.</p>
</div>
</div>
</section><section id="workshop-2-cell-biology" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="workshop-2-cell-biology">
<span class="header-section-number">6.2</span> <a href="https://djeffares.github.io/BIO66I/workshop2.html">Workshop 2: Cell Biology</a>
</h2>
<p>In this workshop, we learned about:</p>
<ul>
<li>Loading data from websites with <code>read_tsv</code> and <code>read_csv</code>.</li>
<li>Exploring data with <code>view</code>, <code>names</code>, <code>ncol</code>, <code>ncol</code>, <code>nrow</code>, <code>summary</code>, and <code>glimpse</code>
</li>
<li>Summarising large data sets with <code>dplyr</code>
</li>
<li>Making plots to compare two or more categories with <code>geom_boxplot</code>, <code>geom_violin</code>, and <code>geom_jitter</code>
</li>
<li>The differences between P-values and plotting small vs large data</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What does this do?
</div>
</div>
<div class="callout-body-container callout-body">
<p>To find out what any function does, type <code>?function</code> in the RStudio Console. For example to find out what <code>glimpse</code> does:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="va">glimpse</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="workshop-3-cell-biology" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="workshop-3-cell-biology">
<span class="header-section-number">6.3</span> <a href="https://djeffares.github.io/BIO66I/workshop3.html">Workshop 3: Cell Biology</a>
</h2>
<p>In this workshop, we learned about:</p>
<ul>
<li>Using <code>summary</code> to describe a large data frame</li>
<li>Adjusting plot with a log scale (often important for biological data)</li>
<li>Using <code>facet_wrap</code> to create multiple panels for different replicate and so on</li>
<li>‘Reshaping’ data tables with <code>pivot_longer</code>
</li>
<li>Correlations between metrics in data sets (this is very common in biological data)</li>
<li>Creating a correlation heat map</li>
</ul></section><section id="workshop-4-cell-biology-this-workshop" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="workshop-4-cell-biology-this-workshop">
<span class="header-section-number">6.4</span> <a href="https://djeffares.github.io/BIO66I/workshop4.html">Workshop 4: Cell Biology (this workshop)</a>
</h2>
<p>We learned:</p>
<ul>
<li>How to make and use a linear model to infer values from a standard curve</li>
<li>How to plot objects on two-dimensional planes</li>
<li>How to use <code>facet_wrap</code> (again)</li>
<li>How to animate plots!</li>
</ul></section></section><section id="reflection" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Reflection</h1>
<p>Ask yourself, and discuss with your classmates:</p>
<ul>
<li>What is your favourite way to quickly get to know a data set?</li>
<li>Why do we make plots?</li>
<li>Is a statistical test always reliable? What if our data set is very small? (or very large?)</li>
<li>What is the value of both laboratory work <em>and</em> data analysis?</li>
<li>Would <strong>you</strong> prefer to do laboratory work, data analysis, or both?</li>
</ul>
<section id="consolodation-exercises" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="consolodation-exercises">
<span class="header-section-number">7.1</span> Consolodation exercises</h2>
<p>To consolidate, follow up on aspects of the previous workshops that you are unsure about. Try some different plots. Break the code, then try and fix it.</p>
</section><section id="planning-for-your-report" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="planning-for-your-report">
<span class="header-section-number">7.2</span> Planning for your report</h2>
<p>The RStudio Project should:</p>
<p>Create a logical folder structure for your analysis. The top folder should be named with your exam number, for example Y12345678, do not include your name in the submission. Your submission should include the script you used for your work, any accessory functions and the data itself. Your script should be well-commented, well-organised and follow good practice in use of spacing, indentation and variable naming. It should include all the code required to reproduce data import and formatting as well as the summary information, analyses and figures in your report.</p>
</section></section><section id="supplementary-analysis-three-way-anova" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Supplementary analysis: three-way ANOVA</h1>
<p>In practical 4, you collected absorbance readings for concentrations of pNP in triplicate, to provide an indication of the two clones to undergo osteogenesis. pNP concentrations were measured in day 0,4 and 8, and at each time point you have data for both induced cells and non-induced cells (negative control), with the exception of day 0 as the differentiation was induced at day 1.</p>
<p>To find out which the conditions affect the pNP, we can carry out a three-way ANOVA is used to compare the effects of three <strong>grouping variables</strong> (day, clone and induction condition) on the one <strong>response variable</strong> (pNP concentration).</p>
<p>The methods below show you how to do this. We first start by assuming that the grouping variables do not interact (ie: combinations of two factors don’t cause different outcomes to each factor alone), in what is called an <strong>additive model</strong>.</p>
<p>But the three grouping variables may have interacting effects, and not be independent. So then we then examine a non-additive (or multiplicative) model. You’ll see more clearly what this means as you do the analysis.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An example of a multiplicative model
</div>
</div>
<div class="callout-body-container callout-body">
<p>Two people (A and B) walk back to their hotel, in a city they don’t know well. Last time, when they both had their phones, it took 30 minutes. When person A lost their phone, so it took 35 minutes (ie: +5 minutes). When <strong>both</strong> A and B lost their phones, it took 60 minutes. This much longer we would expect the lost-phones problem was simply an <strong>additive</strong> effect of two phone being lost (30 + 5 + 5). The problems were multiplicative rather than merely additive.</p>
</div>
</div>
<section id="read-data-and-reformat-with-pivot_longer" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="read-data-and-reformat-with-pivot_longer">
<span class="header-section-number">8.1</span> Read data and reformat with <code>pivot_longer</code>
</h2>
<p>We’ll assume you have the <code>tidyverse</code> and <code>readxl</code> libraries load already. If not load these now.</p>
<p>First, we load the data. Your data file might have a different name. This code will work without adjustment of your file has the same rows and columns as <a href="https://djeffares.github.io/BIO66I/example_alkaline_phosphatase_activity_assay-2024-03-21.xlsx">this example file</a>. We’ll also rename a column, so it’s more intuitive.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#load the data</span></span>
<span><span class="va">ap</span><span class="op">&lt;-</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"raw-data/alkaline-phosphatase-activity-assay-real-data.xlsx"</span>,sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#rename the 'differentiated' column 'induced', which describes it better</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ap</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">'induced'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we need to set some columns to be factors:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#set day, clone and induced columns to be factors</span></span>
<span><span class="va">ap</span><span class="op">$</span><span class="va">day</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ap</span><span class="op">$</span><span class="va">day</span><span class="op">)</span></span>
<span><span class="va">ap</span><span class="op">$</span><span class="va">clone</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ap</span><span class="op">$</span><span class="va">clone</span><span class="op">)</span></span>
<span><span class="va">ap</span><span class="op">$</span><span class="va">induced</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ap</span><span class="op">$</span><span class="va">induced</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#this is what we have:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ap</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we use <code>pivot_longer</code> to reformat the data, so we can use all the repeats. The <code>cols=!c(day,clone,differentiated)</code> part indicates that the day,clone,differentiated columns are not to be lengthened in to the ‘absorb’ column. So it is <code>onlyabsorptionrep1</code>,<code>absorptionrep2</code> and <code>absorptionrep3</code> that are put into the ‘absorb’ column.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ap.pivot</span><span class="op">&lt;-</span><span class="va">ap</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">day</span>,<span class="va">clone</span>,<span class="va">induced</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"rep"</span>, values_to <span class="op">=</span> <span class="st">"absorb"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#this is what we have now</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ap.pivot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="make-some-plots" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="make-some-plots">
<span class="header-section-number">8.2</span> Make some plots</h2>
<p>If we look at the absorbance by day, we can see that absorbance goes up each day. Here we are ignoring the media (<code>induced</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ap.pivot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clone</span>, y <span class="op">=</span> <span class="va">absorb</span>, color <span class="op">=</span> <span class="va">day</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can use <code>facet_wrap</code> to examine the data by day <em>and</em> by media. We can see that clone A has much higher values in the differentiation media.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ap.pivot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clone</span>, y <span class="op">=</span> <span class="va">absorb</span>, color <span class="op">=</span> <span class="va">day</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">induced</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="anova-additive-model" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="anova-additive-model">
<span class="header-section-number">8.3</span> ANOVA (additive model)</h2>
<p>To find out if there is evidence that the absorbance value affected by day, clone or media using an ANOVA, we can use the the R function <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#we save the result in an object called aov.result.additive</span></span>
<span><span class="va">aov.result.add</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">absorb</span> <span class="op">~</span> <span class="va">day</span> <span class="op">+</span> <span class="va">clone</span> <span class="op">+</span> <span class="va">induced</span>, data <span class="op">=</span> <span class="va">ap.pivot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To view the results, we do:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov.result.add</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>When p-values are &lt; 0.05, this means we have a significant effect from this factor.&nbsp; Do day, clone, and the induction media all have a significant effects?</p>
</div>
</div>
</section><section id="anova-multiplicative-model" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="anova-multiplicative-model">
<span class="header-section-number">8.4</span> ANOVA (multiplicative model)</h2>
<p>Now then examine a multiplicative (non additive) model. Here we examine whether interactions between the factors affect the pNP levels. To test this, we simple replace the plus symbol (+) with an asterisk (*) in our code:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#run the ANOVA</span></span>
<span><span class="va">aov.result.mult</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">absorb</span> <span class="op">~</span> <span class="va">day</span> <span class="op">*</span> <span class="va">clone</span> <span class="op">*</span> <span class="va">induced</span>, data <span class="op">=</span> <span class="va">ap.pivot</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#to view the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov.result.mult</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Interpretation:</strong> The multiplicative model all single factors, all pairwise factors (eg: <code>day:clone</code>) and the interaction of all three factors(<code>day:clone:induced</code>). Where the p-values <code>Pr(&gt;F)</code> are &lt; 0.05, we have a significant effect of this factor (or factors) on the pNP level (and therefore osteogenesis).</p>
</section></section><section id="the-end" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> The End</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Did you know ANOVA’s were invented for biological data?
</div>
</div>
<div class="callout-body-container callout-body">
<p>ANOVA’s were invented by a <a href="https://en.wikipedia.org/wiki/Ronald_Fisher">RA Fisher</a>, a British mathematician, statistician, biologist and geneticist. Fisher also had a big influence on evolutionary biology.</p>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>