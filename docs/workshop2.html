<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.545">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Daniel Jeffares">
<meta name="dcterms.date" content="2024-01-25">
<title>BIO00066I - BIO00066I Workshop 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BIO00066I</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./BIO00066I-workshop2.html"> 
<span class="menu-text">Workshop 2</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
<li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><span class="header-section-number">1</span> Learning objectives</a></li>
  <li>
<a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2</span> Introduction</a>
  <ul class="collapse">
<li><a href="#the-biology" id="toc-the-biology" class="nav-link" data-scroll-target="#the-biology"><span class="header-section-number">2.1</span> The biology</a></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions"><span class="header-section-number">2.2</span> Research questions</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">2.3</span> The data</a></li>
  </ul>
</li>
  <li>
<a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">3</span> Exercises</a>
  <ul class="collapse">
<li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"><span class="header-section-number">3.1</span> Getting started</a></li>
  <li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data"><span class="header-section-number">3.2</span> Loading the data</a></li>
  <li><a href="#exploring-the-data" id="toc-exploring-the-data" class="nav-link" data-scroll-target="#exploring-the-data"><span class="header-section-number">3.3</span> Exploring the data</a></li>
  <li><a href="#summarise-with-dplyr" id="toc-summarise-with-dplyr" class="nav-link" data-scroll-target="#summarise-with-dplyr"><span class="header-section-number">3.4</span> Summarise with dplyr</a></li>
  <li><a href="#making-plots" id="toc-making-plots" class="nav-link" data-scroll-target="#making-plots"><span class="header-section-number">3.5</span> Making plots</a></li>
  </ul>
</li>
  <li><a href="#next-step-modify-the-code" id="toc-next-step-modify-the-code" class="nav-link" data-scroll-target="#next-step-modify-the-code"><span class="header-section-number">4</span> Next step: modify the code</a></li>
  <li><a href="#analysis-with-small-data" id="toc-analysis-with-small-data" class="nav-link" data-scroll-target="#analysis-with-small-data"><span class="header-section-number">5</span> Analysis with small data</a></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="header-section-number">6</span> Reflection</a></li>
  <li>
<a href="#after-the-workshop" id="toc-after-the-workshop" class="nav-link" data-scroll-target="#after-the-workshop"><span class="header-section-number">7</span> After the workshop</a>
  <ul class="collapse">
<li><a href="#consolidation-exercises" id="toc-consolidation-exercises" class="nav-link" data-scroll-target="#consolidation-exercises"><span class="header-section-number">7.1</span> Consolidation exercises</a></li>
  <li><a href="#planning-for-your-report" id="toc-planning-for-your-report" class="nav-link" data-scroll-target="#planning-for-your-report"><span class="header-section-number">7.2</span> Planning for your report</a></li>
  </ul>
</li>
  <li><a href="#the-end." id="toc-the-end." class="nav-link" data-scroll-target="#the-end."><span class="header-section-number">8</span> The end.</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">BIO00066I Workshop 2</h1>
<p class="subtitle lead">Cell Biology Data Analysis Workshop 2</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Jeffares </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 25, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><p><strong>Colour scheme</strong></p>
<p>In these workshops, we highlight some elements in boxes like this:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important concepts
</div>
</div>
<div class="callout-body-container callout-body">
<p>Particularly important ideas or skills.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Be careful
</div>
</div>
<div class="callout-body-container callout-body">
<p>Where to be careful.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to think about
</div>
</div>
<div class="callout-body-container callout-body">
<p>What does this result show about the biology?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Information
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://en.wikipedia.org/wiki/Mesenchymal_stem_cell">Mesenchymal stem cells</a> are multipotent, but not pluripotent.</p>
</div>
</div>
<section id="learning-objectives" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Learning objectives</h1>
<p>In this workshop, you will learn <strong><em>technical skills</em></strong> and <strong><em>data science concepts</em></strong>.</p>
<p><strong>Technical skills</strong></p>
<ul>
<li>RStudio skills to manage, view and analyse large data sets</li>
<li>How to create plots in RStudio to assist with exploring and interpreting data</li>
<li>How to make your data analysis reproducible and well-explained</li>
</ul>
<p><strong>Thinking like a data scientist</strong></p>
<ul>
<li>How to interpret data with care</li>
<li>How to integrate knowledge from laboratory work and computational analysis</li>
</ul></section><section id="introduction" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Introduction</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Philosophy
</div>
</div>
<div class="callout-body-container callout-body">
<p>Workshops are not a test. It’s OK to make mistakes. It’s OK to need help. You should be familiar with independent study content before the workshop, but you don’t need to understand <strong>every detail</strong>. The workshop will hlpe you to build and consolidate your understanding. Tips:</p>
<ul>
<li>there are <strong>no stupid questions</strong> (ask us anything!)</li>
<li>don’t worry about making mistakes (we all make mistakes)</li>
<li>discuss code with your neighbours and with the staff</li>
<li>outside of workshop times, google is a good resource</li>
</ul>
</div>
</div>
<section id="the-biology" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="the-biology">
<span class="header-section-number">2.1</span> The biology</h2>
<p>Today we will look at some data from mesenchymal stem cells (MSCs, sometimes called stromal cells). MCSs are are <em>multipotent</em> stem cells, than can differentiate into many kinds of mesenchymal cells: bone, cartilage and fat cells. They are not <em>pluripotent</em>, in that they do have limits about how they differentiate.</p>
<p>MSCs are also:</p>
<ul>
<li>immuno-modulatory (they make cytokines)</li>
<li>heterogeneous (they have subpopulations that are different from each other)</li>
</ul>
<p><strong>The MSCs we are looking at</strong> are from bone marrow femoral head tissues (from the hip bone). These MSCs were <em>immortalised</em> (by XXX), and then cloned by limiting dilution. We will compare the data on cell shape and size from just <strong>two clones</strong>, both obtained from one person’s femoral head tissues. Each <em>clone</em> was derived from a <em>single cell</em> from the person.</p>
<p>We call these two clones <em>clone A</em> and <em>clone B</em>. Today, we will use our data analysis skills to explore how these cells differ.</p>
</section><section id="research-questions" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="research-questions">
<span class="header-section-number">2.2</span> Research questions</h2>
<ol type="1">
<li>What parameters do we have in the data obtained from the XXX machine/method?</li>
<li>Which parameters differ between the clones?</li>
<li>Which parameters are correlated?</li>
</ol></section><section id="the-data" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="the-data">
<span class="header-section-number">2.3</span> The data</h2>
<p>The data we have today are derived from an XXX machine. We grew each clones in XXX media, and captured cell shape an size information for many cells from each clones with XXX machine. For each clone, we measured three <em>biological replicates</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Biological replicates and technical replicates
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>A biological replicate</strong> repeats an experiment from different cell types, tissue types, or organisms to see if similar results can be observed.</p>
<p><strong>Technical replicates</strong> are repeat measurements of <em>the same biological material</em>, which help to show how much variation comes from the equipment or different methods (rather from the biology).</p>
<p>Our replicates are almost <em>biological replicates</em>, because we grew the cells three times.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Thinking like a data scientist
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data science can be challenging when you first start. But data science does have core concepts, like any other science.</p>
<ul>
<li>Consider the motivation or scientific question <em>before</em> drawing a plot</li>
<li>Reflect on how the plot or analysis addresses the scientific question</li>
<li>Use each plots to adapt, to inspire new research questions and new inquiries</li>
<li>Ensure that your scripts are reproducible and clearly commented</li>
<li><strong>Consider what the results tell you about the biology</strong></li>
</ul>
</div>
</div>
</section></section><section id="exercises" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Exercises</h1>
<section id="getting-started" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="getting-started">
<span class="header-section-number">3.1</span> Getting started</h2>
<ol type="1">
<li>Start RStudio from the Start menu</li>
<li>Open your RStudio project using the dropdown menu at the very <strong>top right</strong> of the RStudio window.</li>
<li>Make a new script then save it with a sensible name that will help you to know later what is in this file. <code>BIO00066I-workshop2.R</code> would work.</li>
<li>Add a comment to the script so you know what it is about, for example</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Data Analysis 2: Cell Biology</span></span>
<span><span class="co">#date 2024-30-01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Clear all the previous data, and load <strong><code>tidyverse</code></strong> package by adding these lines to your script:</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#clear previous data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#load the tidyverse</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>Finally load another library that allows us to make multi-part plots (this can be useful sometimes). #we need this to make pretty plots with the ‘ggarrange’ package</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#load the ggpubr package for multi-part plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li>Make sure all these lines of code are in your script, with comments.</li>
<li>Save the script.</li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comment your code!
</div>
</div>
<div class="callout-body-container callout-body">
<p>In R scripts, lines that start with the hash symbol (<code>#</code>) are comments.</p>
<p>Commenting code makes it readable, for you and anyone else. Good data science includes clearly commented code.</p>
</div>
</div>
</section><section id="loading-the-data" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="loading-the-data">
<span class="header-section-number">3.2</span> Loading the data</h2>
<p>In workshop 1, we showed you how to <a href="https://3mmarand.github.io/R4BABS/r4babs1/week-8/workshop.html#importing-data-from-files">import data from files</a>. Today, we load a tab-separated value (TSV) file from a website:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cells</span> <span class="op">&lt;-</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_tsv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://djeffares.github.io/BIO66I/data/all-cell-data-FFT.filtered.2024-01-19.tsv"</span><span class="op">)</span>,</span>
<span>    col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span></span>
<span>        clone <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        replicate <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        tracking.id<span class="op">=</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        ineage.id<span class="op">=</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About read_tsv
</div>
</div>
<div class="callout-body-container callout-body">
<p>We use the <code>read_tsv</code> function to read the tab-separated value file. Clicking on the link in the <code>read_tsv</code> takes you to a website about this function. <strong>All the code chunks in these workshops have links like this.</strong></p>
<p>The <code>clone = col_factor(),replicate = col_factor()</code> part let’s R know that we want the <em>clone</em> column and the <em>replicate</em> column to be factors, rather than numeric values. Factors are used to represent categorical data.</p>
</div>
</div>
</section><section id="exploring-the-data" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="exploring-the-data">
<span class="header-section-number">3.3</span> Exploring the data</h2>
<p>It is important to know what data you have. How many rows and columns <em>etc</em>.</p>
<p>There are many ways to do this in R. Here are some of our favourites. Copy and past these into your R script, and try them out.</p>
<p>##Amanda: should we remove some of the less-useful columns? #This will keep it simple for the students #Are the different measurements of cell size &amp; shape <em>independent</em> measures?</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#look at the data, like an excel table:</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/view.html">view</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#what are the names of the columns?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#how many rows and columns you we have?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#other ways to peek at data:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which method of do <em>you</em> like the best?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why not take a note of this, and use it all the time?</p>
</div>
</div>
<section id="what-is-in-the-data" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="what-is-in-the-data">
<span class="header-section-number">3.3.1</span> What is in the data?</h3>
<p>You may have noticed that we have two clones (cloneA and cloneB). For each clone, we have three replicates. For each replicate, we have many readings of cell widths, cell volume, cell sphericity and so on.</p>
<p><strong>Now save your data and save your script.</strong> This command will save <strong>all</strong> the variables you have loaded, or created so far:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#save all my stuff</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save.image</a></span><span class="op">(</span><span class="st">"BIO00066I-workshop2.Rda"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can load all the data again with:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#load all my stuff from last time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"BIO00066I-workshop2.Rda"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="summarise-with-dplyr" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="summarise-with-dplyr">
<span class="header-section-number">3.4</span> Summarise with dplyr</h2>
<p>The <code>view(cells)</code> command shows that we have many cell shape metrics. We saw a summary of our cell shape metrics with the <code>summary(cells)</code> command above.</p>
<p>Now we will do something even better, by using a tool from the <code>dplyr</code> package (part of the <code>tidyverse</code>) to make some sense of all this data very quickly.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
dplyr is wonderful
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>dplyr</code> is like a set of pliers, helping us to ‘bend’ or ‘reshape’ our data.</p>
</div>
</div>
<p>Here is the command. I will explain it below.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary.table</span> <span class="op">&lt;-</span> <span class="va">cells</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">clone</span>, <span class="va">replicate</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        volume<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">volume</span><span class="op">)</span>,</span>
<span>        mean.thickness<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">mean.thickness</span><span class="op">)</span>,</span>
<span>        radius<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">radius</span><span class="op">)</span>,</span>
<span>        area<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span>,</span>
<span>        sphericity<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">sphericity</span><span class="op">)</span>,</span>
<span>        length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span>,</span>
<span>        dry.mass<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dry.mass</span><span class="op">)</span>,</span>
<span>        perimeter<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">perimeter</span><span class="op">)</span>,</span>
<span>        length.to.width<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">length.to.width</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="what-this-code-does" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="what-this-code-does">
<span class="header-section-number">3.4.1</span> What this code does</h3>
<ul>
<li><p>The <code>cells |&gt;</code> part takes the data from the <code>cells</code> data frame, and ‘pipes’ it into the <code>group_by</code> function. The <code>|&gt;</code> symbol as means <strong>put this data into the next bit</strong>.</p></li>
<li><p><code>group_by(clone, replicate)</code> means that make groups of data, according to which clone they are, and which replicate culture they were from.</p></li>
<li><p><code>summarise</code> calculates some summaries of all the data rows (for each clone and replicate). The part <code>volume=median(volume)</code> creates a header called <code>volume</code> and fills this with the median cell volume for each clone and replicate</p></li>
<li><p>Right at the top, <code>summary.table &lt;-</code> stores the results of all the piping in an object called <code>summary.table</code>.</p></li>
</ul>
<p>Have a look at the information we generated with:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/view.html">view</a></span><span class="op">(</span><span class="va">summary.table</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Do you see any patterns in this data?
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>What does this table tell you about <strong>clone A</strong> and <strong>clone B</strong>?</li>
<li>What does this tell you about mesenchymal stem cells?</li>
</ul>
</div>
</div>
<hr></section></section><section id="making-plots" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="making-plots">
<span class="header-section-number">3.5</span> Making plots</h2>
<p>It looks like many of the cell shape metrics from above might differ between clones. So let’s look deeper, starting with <code>cell width</code>. We will make a box and whisker plot. We use a small ‘trick’ here: by including <code>fill=replicate</code> we force R to make different plots for each replicate.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cells</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">clone</span>,y<span class="op">=</span><span class="va">width</span>,fill<span class="op">=</span><span class="va">replicate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Making plots with ggplot
</div>
</div>
<div class="callout-body-container callout-body">
<p>No matter what shape plot you want, <code>ggplot</code> uses the same syntax.</p>
<ol type="1">
<li>Start by telling R what data you want to use like this: <code>ggplot(some_data_frame,aes(x=x_axis_data, y=y_axis_data) +</code>
</li>
</ol>
<p>In this line, <code>x_axis_data</code> and <code>y_axis_data</code> are columns of some_data_frame.</p>
<ol start="2" type="1">
<li>Then define what the shape plot you want (the ‘geometry’): <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> etc.</li>
<li>Add extra things to customise your plot, eg: <code>xlab("my x axis label")</code>
</li>
</ol>
<p>If you are unsure what to do, it’s OK to ask! Googling “ggpplot how to make a boxplot” (or any other plot) will help.</p>
</div>
</div>
<p>It does look like clone A and clone B differ consistently in width, with all repeats. To prove this, we would like to do a statistical test. A Student’s t-Test <code>t.test</code> would work. But t-Test’s assume that the data are normally distributed (like a bell curve).</p>
<p>We can test this approximately by plotting data, as below. It doesn’t look perfectly ‘bell shaped’, so let’s play is safe and use a nonparametric test.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cells</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The nonparametric equivalent of a t-Test is a <strong>Wilcoxon rank sum test</strong>. There are two ways to run this test in R. We can do <code>wilcox.test(vectorA, vectorB)</code>, where vectorA and vectorB contain the numeric values we want to test.</p>
<p>But does does not suit <code>tidyverse</code> data frames very well. So we will use the <code>wilcox.test(numberic_value ~ categorry_name, data = some_data_frame)</code> method, like so:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Wilcoxon rank sum test</span></span>
<span><span class="co">#To test if cloneA and cloneB have statistically different widths</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">width</span> <span class="op">~</span> <span class="va">clone</span>, data <span class="op">=</span> <span class="va">cells</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  width by clone
W = 562074424, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>Because the <code>p-value</code> is <em>very low</em> (&lt; 2.2e-16), this means the null hypothesis (that both sets of numbers come from the same population) is <em>very</em> unlikely to be true.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Non-parametric tests are safe
</div>
</div>
<div class="callout-body-container callout-body">
<p>Parametric tests are based on assumptions about the distribution of the real data. Nonparametric statistics are not based on these assumptions. So they are safer. Many biological metrics need nonparametric tests.</p>
</div>
</div>
<section id="an-easier-way" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="an-easier-way">
<span class="header-section-number">3.5.1</span> An easier way</h3>
<p>Fortunately, you can add the results of nonparametric tests to ggplot, by adding <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means()</a></code> to our plot. Note that below we do not force R to split up the replicates as we did above.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cells</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">clone</span>,y<span class="op">=</span><span class="va">width</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="next-step-modify-the-code" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Next step: modify the code</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practise makes perfect
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>To increase your ubderstanding, run through all the plots in section 3.5 with some other cell shape or size metric.</p>
<p>To start, find what metrics are present with:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We suggest using one of these, in place of <code>width</code>:</p>
<ul>
<li>volume</li>
<li>mean.thickness</li>
<li>radius</li>
<li>area</li>
<li>sphericity</li>
<li>length</li>
<li>dry.mass</li>
</ul></section><section id="analysis-with-small-data" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Analysis with small data</h1>
<p>So far, we have used <strong>all</strong> the rows in our data frame. But perhaps, this isn’t wise.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#take the mean of each unique tracking id</span></span>
<span><span class="va">trackingid.summary.table</span><span class="op">&lt;-</span><span class="va">cells</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">clone</span>, <span class="va">replicate</span>, <span class="va">tracking.id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        volume<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">volume</span><span class="op">)</span>,</span>
<span>        mean.thickness<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">mean.thickness</span><span class="op">)</span>,</span>
<span>        radius<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">radius</span><span class="op">)</span>,</span>
<span>        area<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span>,</span>
<span>        sphericity<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">sphericity</span><span class="op">)</span>,</span>
<span>        length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span>,</span>
<span>        dry.mass<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dry.mass</span><span class="op">)</span>,</span>
<span>        perimeter<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">perimeter</span><span class="op">)</span>,</span>
<span>        length.to.width<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">length.to.width</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'clone', 'replicate'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#how many rows</span></span>
<span><span class="va">row.count</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">trackingid.summary.table</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#subset</span></span>
<span><span class="co">#sample_n samples a number of rows at random</span></span>
<span><span class="co">#If the data frame is grouped, the number applies to each group</span></span>
<span><span class="co">#Our sample is group by </span></span>
<span><span class="va">trackingid.small.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="va">trackingid.summary.table</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">trackingid.summary.table</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 13,688
Columns: 12
Groups: clone, replicate [6]
$ clone           &lt;fct&gt; cloneA, cloneA, cloneA, cloneA, cloneA, cloneA, cloneA…
$ replicate       &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ tracking.id     &lt;fct&gt; 1, 2, 534, 537, 3, 814, 4, 7, 9, 11, 12, 661, 13, 14, …
$ volume          &lt;dbl&gt; 1154.725, 1725.695, 1269.765, 1248.555, 1654.985, 1176…
$ mean.thickness  &lt;dbl&gt; 1.2803999, 1.2148985, 2.1121036, 1.0129144, 1.3742726,…
$ radius          &lt;dbl&gt; 16.94749, 21.55961, 14.41782, 19.69785, 20.18902, 11.1…
$ area            &lt;dbl&gt; 903.430, 1460.270, 674.805, 1219.025, 1280.555, 393.50…
$ sphericity      &lt;dbl&gt; 0.2850, 0.2350, 0.4360, 0.2210, 0.2635, 0.6080, 0.2500…
$ length          &lt;dbl&gt; 61.410, 94.550, 55.825, 105.475, 79.120, 26.560, 50.01…
$ dry.mass        &lt;dbl&gt; 288.680, 431.420, 317.435, 312.135, 413.740, 294.060, …
$ perimeter       &lt;dbl&gt; 151.020, 223.540, 134.055, 215.225, 199.255, 71.850, 1…
$ length.to.width &lt;dbl&gt; 2.560749, 2.754384, 2.443677, 3.612040, 3.034136, 1.34…</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">trackingid.small.data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">trackingid.summary.table</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 13,688
Columns: 12
Groups: clone, replicate [6]
$ clone           &lt;fct&gt; cloneA, cloneA, cloneA, cloneA, cloneA, cloneA, cloneA…
$ replicate       &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ tracking.id     &lt;fct&gt; 1, 2, 534, 537, 3, 814, 4, 7, 9, 11, 12, 661, 13, 14, …
$ volume          &lt;dbl&gt; 1154.725, 1725.695, 1269.765, 1248.555, 1654.985, 1176…
$ mean.thickness  &lt;dbl&gt; 1.2803999, 1.2148985, 2.1121036, 1.0129144, 1.3742726,…
$ radius          &lt;dbl&gt; 16.94749, 21.55961, 14.41782, 19.69785, 20.18902, 11.1…
$ area            &lt;dbl&gt; 903.430, 1460.270, 674.805, 1219.025, 1280.555, 393.50…
$ sphericity      &lt;dbl&gt; 0.2850, 0.2350, 0.4360, 0.2210, 0.2635, 0.6080, 0.2500…
$ length          &lt;dbl&gt; 61.410, 94.550, 55.825, 105.475, 79.120, 26.560, 50.01…
$ dry.mass        &lt;dbl&gt; 288.680, 431.420, 317.435, 312.135, 413.740, 294.060, …
$ perimeter       &lt;dbl&gt; 151.020, 223.540, 134.055, 215.225, 199.255, 71.850, 1…
$ length.to.width &lt;dbl&gt; 2.560749, 2.754384, 2.443677, 3.612040, 3.034136, 1.34…</code></pre>
</div>
</div>
</section><section id="reflection" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Reflection</h1>
<ul>
<li>After loading the data, what did we do first?</li>
<li>What did making the plots do that summary statistics (liek average, or median) cannot do?</li>
<li>What did we learn about the two clones?</li>
</ul></section><section id="after-the-workshop" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> After the workshop</h1>
<p>Look at your script again. Add some comments, so that the next time you look at it, it will make more sense to you.</p>
<p>Also, have a go at the consolidation exercises below.</p>
<section id="consolidation-exercises" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="consolidation-exercises">
<span class="header-section-number">7.1</span> Consolidation exercises</h2>
<ol type="1">
<li>We used <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>to show the differences between categories (clone A and clone B). Try <code>geom_violin</code> instead. Which one do you prefer?</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cells</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">clone</span>,y<span class="op">=</span><span class="va">width</span>,fill<span class="op">=</span><span class="va">replicate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Now adjust the title with <code>ggtitle(label)</code>, and the axis labels with <code>xlab(label)</code> and <code>ylab(label)</code>, and the <strong>theme</strong> (the general style of the plot), with <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic()</a></code>. Use whatever theme you feel makes the data clear.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cells</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">clone</span>,y<span class="op">=</span><span class="va">length</span>,fill<span class="op">=</span><span class="va">replicate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"something"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"clone"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"length"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="planning-for-your-report" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="planning-for-your-report">
<span class="header-section-number">7.2</span> Planning for your report</h2>
</section></section><section id="the-end." class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> The end.</h1>
<p>We hope this was useful.</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>